<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimization algorithms · StochasticVehicleScheduling.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://BatyLeo.github.io/StochasticVehicleScheduling.jl/algorithms/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">StochasticVehicleScheduling.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../math/">Problem statement</a></li><li><a class="tocitem" href="../dataset/">Instance generator</a></li><li class="is-active"><a class="tocitem" href>Optimization algorithms</a><ul class="internal"><li><a class="tocitem" href="#Heuristic-algorithms"><span>Heuristic algorithms</span></a></li><li><a class="tocitem" href="#Exact-algorithms"><span>Exact algorithms</span></a></li></ul></li><li><span class="tocitem">Learning with InferOpt.jl</span><ul><li><a class="tocitem" href="../inferopt/">InferOpt tutorial</a></li><li><a class="tocitem" href="../paper/">Reproducing paper experiments</a></li></ul></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Optimization algorithms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Optimization algorithms</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/BatyLeo/StochasticVehicleScheduling.jl/blob/main/docs/src/literate/algorithms.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Optimization-algorithms"><a class="docs-heading-anchor" href="#Optimization-algorithms">Optimization algorithms</a><a id="Optimization-algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-algorithms" title="Permalink"></a></h1><p>In this section, we describe the various optimization algorithms implemented in this package, and illustrate them on the following small instance, with 25 tasks and 10 scenarios:</p><pre><code class="language-julia hljs">using StochasticVehicleScheduling
using Random
Random.seed!(1)  # fix the seed for reproducibility
instance = create_random_instance(; nb_tasks=25, nb_scenarios=10)

using Plots
fig = plot()
for i in 1:(get_nb_tasks(instance) + 1)
    task = instance.city.tasks[i]
    (; start_point, end_point) = task
    points = [(start_point.x, start_point.y), (end_point.x, end_point.y)]
    plot!(fig, points; color=:black, label=&quot;&quot;)
    scatter!(
        fig,
        points;
        marker=:rect,
        markersize=10,
        label=&quot;&quot;,
        series_annotations=[(&quot;$(i-1)&quot;, 9), &quot;&quot;],
    )
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">qt.qpa.xcb: could not connect to display
qt.qpa.plugin: Could not load the Qt platform plugin &quot;xcb&quot; in &quot;&quot; even though it was found.
This application failed to start because no Qt platform plugin could be initialized. Reinstalling the application may fix this problem.

Available platform plugins are: linuxfb, minimal, offscreen, vnc, xcb.

Aborted (core dumped)
connect: Connection refused
GKS: can&#39;t connect to GKS socket application

GKS: Open failed in routine OPEN_WS
GKS: GKS not in proper state. GKS must be either in the state WSOP or WSAC in routine ACTIVATE_WS</code></pre><p><img src="../instance.png" alt="instance"/></p><h2 id="Heuristic-algorithms"><a class="docs-heading-anchor" href="#Heuristic-algorithms">Heuristic algorithms</a><a id="Heuristic-algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Heuristic-algorithms" title="Permalink"></a></h2><p>The first category of algorithms implemented are heuristics, which given good but not necessarily optimal solutions in a short amount of time.</p><h3 id="Deterministic-heuristic"><a class="docs-heading-anchor" href="#Deterministic-heuristic">Deterministic heuristic</a><a id="Deterministic-heuristic-1"></a><a class="docs-heading-anchor-permalink" href="#Deterministic-heuristic" title="Permalink"></a></h3><p>The first heuristic consists in solving a deterministic version of the instance, which minimizes vehicle costs plus travel costs of vehicles:</p><p class="math-container">\[\begin{aligned}
\min &amp; \, c_{\text{vehuicle}}\sum_{a\in \delta^+(o)} y_a + c_{\text{delay}}\sum_{a\in a}w_a y_a &amp;\\
s.t. &amp; \sum_{a\in \delta^-(v)} y_a = \sum_{a\in \delta^+(v)} y_a, &amp; \forall v \in\bar V\\
&amp; \sum_{a\in \delta^-(v)} y_a = 1, &amp; \forall v \in\bar V\\
&amp; y_a \in \{0, 1\}, &amp;\forall a\in A
\end{aligned}\]</p><p>This is a linear flow program very easy to solve:</p><pre><code class="language-julia hljs">_, h_solution = solve_deterministic_VSP(instance)
h_value = evaluate_solution(h_solution, instance)
println(&quot;Heuristic solution value: $h_value&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Heuristic solution value: 7696.754564078043</code></pre><h3 id="Local-search"><a class="docs-heading-anchor" href="#Local-search">Local search</a><a id="Local-search-1"></a><a class="docs-heading-anchor-permalink" href="#Local-search" title="Permalink"></a></h3><p>A more advanced heuristic is the local search, which uses the deterministic solution as an initialization point, and try to improve it by applying elementary modifications to it.</p><pre><code class="language-julia hljs">ls_solution = heuristic_solution(instance; nb_it=1_000)
ls_value = evaluate_solution(ls_solution, instance)
println(&quot;Local search solution value: $ls_value&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Local search solution value: 6810.623923188165</code></pre><p>We obtain a better solution than the previous heuristic!</p><h2 id="Exact-algorithms"><a class="docs-heading-anchor" href="#Exact-algorithms">Exact algorithms</a><a id="Exact-algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Exact-algorithms" title="Permalink"></a></h2><p>There are also two exact optimization algorithms implemented in this package.</p><h3 id="MIP-formulation"><a class="docs-heading-anchor" href="#MIP-formulation">MIP formulation</a><a id="MIP-formulation-1"></a><a class="docs-heading-anchor-permalink" href="#MIP-formulation" title="Permalink"></a></h3><p>One way to solve the stochastic vehicle scheduling problem is to model it as the following linear program with quadratic constraints:</p><p class="math-container">\[\begin{aligned}
\min_{d, y} &amp; \,c_{\text{delay}}\dfrac{1}{|S|}\sum\limits_{s\in S}\sum\limits_{v\in V\backslash\{o,d\}} d_v^s + c_{\text{vehicle}} \sum\limits_{a\in\delta^+(o)}y_a\\
\text{s.t.} &amp; \sum_{a\in\delta^-(v)}y_a = \sum_{a\in\delta^+(v)}y_a &amp;\forall v\in \bar V\\
&amp; \sum_{a\in\delta^-(v)}y_a = 1 &amp;\forall v\in \bar V\\
&amp; d_v^s \geq \gamma_v^s + \sum_{\substack{a\in\delta^-(v) \\ a=(u, v)}} (d_u^s - \delta_{u, v}^s) y_a &amp; \forall v\in \bar V, \forall s\in S\\
&amp; d_v^s\geq \gamma_v^s &amp; \forall v\in \bar V, \forall s\in S\\
&amp; y_a\in\{0,1\} &amp; \forall a\in A
\end{aligned}\]</p><p>Quadratic delay constraints can be linearized using <a href="https://optimization.mccormick.northwestern.edu/index.php/McCormick_envelopes">Mc Cormick linearization</a>.</p><pre><code class="language-julia hljs">mip_value, mip_solution = solve_scenarios(instance)
println(&quot;MIP optimal value: $mip_value&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MIP optimal value: 6792.2213746798225</code></pre><p>The solution value is better than both heuristic values, as expected.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This method does not scale well with tasks and scenarios number.</p></div></div><h3 id="Column-generation-formulation"><a class="docs-heading-anchor" href="#Column-generation-formulation">Column generation formulation</a><a id="Column-generation-formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Column-generation-formulation" title="Permalink"></a></h3><p>Another option is to use a column generation approach with variables <span>$y_P$</span> which equals one if route <span>$P\in \mathycal P$</span> is selected. Cost of a path <span>$P$</span>: <span>$c_P^s = c_{\text{vehicle}} + c_\text{delay}\times \sum_{v\in P} d_v^s$</span></p><p class="math-container">\[\begin{aligned}
\min &amp; \frac{1}{|S|}\sum_{s\in S}\sum_{P\in\mathcal{P}}c_P^s y_P &amp;\\
\text{s.t.} &amp; \sum_{p\ni v} y_P = 1 &amp; \forall v\in \bar V &amp; \quad(\lambda_v\in\mathbb R)\\
&amp; y_P\in\{0,1\} &amp; \forall p\in \mathcal{P} &amp;
\end{aligned}\]</p><p>The associated sub-problem of the column generation formulation is a constrained shortest path problem of the form :</p><p class="math-container">\[\min_{P\in\mathcal P} (c_P  - \sum_{v\in P}\lambda_v)\]</p><p>It can be solved using generalized <span>$A^\star$</span> algorithms (see theoretical details <a href="https://arxiv.org/abs/1504.07880">Parmentier 2017</a> and <a href="https://github.com/BatyLeo/ConstrainedShortestPaths.jl">ConstrainedShortestPath.jl</a> for its Julia implementation).</p><pre><code class="language-julia hljs">col_solution = column_generation_algorithm(instance)
col_value = evaluate_solution(col_solution, instance)
println(&quot;Column generation optimal value: $col_value&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Column generation optimal value: 6792.221374679822</code></pre><p>The column generation solution has the same value as the MIP one, as expected (both are optimal).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Column generation works better than the direct MIP, but still does not scale well when the number of tasks and scenarios increase too much. One way to do better is to use <code>InferOpt.jl</code> to build and learn an hybrid pipeline containing machine learning and combinatorial optimization layers. Checkout the <a href="../inferopt/#InferOpt-tutorial">InferOpt tutorial</a> for an in-depth tutorial.</p></div></div><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dataset/">« Instance generator</a><a class="docs-footer-nextpage" href="../inferopt/">InferOpt tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 18 July 2023 10:17">Tuesday 18 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
